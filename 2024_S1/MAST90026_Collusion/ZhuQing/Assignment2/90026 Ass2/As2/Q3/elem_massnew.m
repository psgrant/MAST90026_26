function M = elem_massnew(P1, P2, P3,Q1,Q2,Q3, Q)
j11=P2(1)-P1(1);
j12=P3(1)-P1(1);
j21=P2(2)-P1(2);
j22=P3(2)-P1(2);
detJ=(j11*j22-j12*j21);
K=abs(detJ);
mass=zeros(3,3);
        mass(1,1)=2*Q(Q1)/9;
        mass(1,2)=2*Q(Q2)/9;
        mass(1,3)=2*Q(Q3)/9;
        mass(2,1)=2*Q(Q1)/9;
        mass(2,2)=2*Q(Q2)/9;
        mass(2,3)=2*Q(Q3)/9;
        mass(3,1)=2*Q(Q1)/9;
        mass(3,2)=2*Q(Q2)/9;
        mass(3,3)=2*Q(Q3)/9;
        mass=mass*K/2;
        M=mass;
